# Task 4 测试验证计划

## 测试目标

根据 Task 4 的要求，需要验证以下内容：
1. ✅ 切换英文，日志/GUI日志面板全为英文
2. ✅ 随机触发 2–3 个异常路径，确认 GUI 弹窗展示翻译后的 exception.* key
3. ✅ 敏感信息在日志中已脱敏
4. ✅ GUI 日志面板（append_log）展示的内容同样已脱敏

## 测试环境准备

1. **启动应用**：运行主程序
2. **切换到英文**：在顶部工具栏的语言下拉框中选择 "English"
3. **观察日志面板**：确认所有文本均为英文

## 测试页面清单

### 1. 频道模式页面 (Channel Page)
**功能点**：
- [ ] 输入频道 URL
- [ ] 点击"检查新视频(Dry Run)"按钮
- [ ] 点击"开始处理"按钮
- [ ] 观察日志输出（应全部为英文）
- [ ] 观察状态栏统计信息（应全部为英文）

**异常测试**：
- [ ] 输入无效的频道 URL（如 `https://invalid-url`）
- [ ] 输入不存在的频道 URL
- [ ] 观察错误弹窗和日志（应显示翻译后的 exception.* key）

### 2. URL 列表模式页面 (URL List Page)
**功能点**：
- [ ] 输入多个视频 URL
- [ ] 点击"检查新视频(Dry Run)"按钮
- [ ] 点击"开始处理"按钮
- [ ] 观察日志输出（应全部为英文）
- [ ] 测试"导入文件"功能
- [ ] 测试"去重"功能
- [ ] 测试"清空"功能

**异常测试**：
- [ ] 输入无效的 URL（如 `https://invalid-url`）
- [ ] 输入空的 URL 列表
- [ ] 观察错误弹窗和日志（应显示翻译后的 exception.* key）

### 3. 运行参数页面 (Run Params Page)
**功能点**：
- [ ] 修改并发数设置
- [ ] 修改重试次数设置
- [ ] 观察并发数警告提示（应全部为英文）
- [ ] 观察日志输出（应全部为英文）

**异常测试**：
- [ ] 输入无效的并发数（如负数或过大值）
- [ ] 观察错误提示（应全部为英文）

### 4. 网络设置页面 (Network Settings Page)
**功能点**：
- [ ] Cookie 配置：
  - [ ] 输入 Cookie 字符串
  - [ ] 点击"测试 Cookie"按钮
  - [ ] 点击"保存 Cookie"按钮
  - [ ] 观察日志输出（应全部为英文）
  - [ ] 观察 Cookie 状态显示（应全部为英文）
- [ ] 代理配置：
  - [ ] 输入代理列表
  - [ ] 点击"测试代理"按钮
  - [ ] 点击"保存代理设置"按钮
  - [ ] 观察日志输出（应全部为英文）
  - [ ] 观察代理测试结果（应全部为英文）

**异常测试**：
- [ ] 输入无效的 Cookie 格式
- [ ] 输入无效的代理地址（如 `invalid-proxy`）
- [ ] 输入无效的代理格式（如 `http://` 没有地址）
- [ ] 观察错误弹窗和日志（应显示翻译后的 exception.* key）

**敏感信息脱敏测试**：
- [ ] 在 Cookie 中包含敏感信息（如 `PREF=...`），观察日志中是否脱敏
- [ ] 在代理中包含认证信息（如 `http://user:pass@proxy.com`），观察日志中密码是否脱敏

### 5. Cookie 页面 (Cookie Page)
**功能点**：
- [ ] 输入 Cookie 字符串
- [ ] 点击"测试 Cookie"按钮
- [ ] 点击"保存 Cookie"按钮
- [ ] 观察日志输出（应全部为英文）

**异常测试**：
- [ ] 输入无效的 Cookie 格式
- [ ] 观察错误弹窗和日志（应显示翻译后的 exception.* key）

### 6. 代理页面 (Proxy Page)
**功能点**：
- [ ] 输入代理列表
- [ ] 点击"测试代理"按钮
- [ ] 点击"保存代理设置"按钮
- [ ] 观察日志输出（应全部为英文）

**异常测试**：
- [ ] 输入无效的代理地址
- [ ] 输入超时的代理地址（如 `socks5://127.0.0.0:9999`）
- [ ] 观察错误弹窗和日志（应显示翻译后的 exception.* key）

### 7. 翻译&摘要页面 (Translation Summary Page)
**功能点**：
- [ ] 配置翻译 AI：
  - [ ] 选择 AI 供应商
  - [ ] 输入 API Key
  - [ ] 点击"保存翻译 AI 配置"按钮
  - [ ] 点击"测试连接"按钮
  - [ ] 观察日志输出（应全部为英文）
- [ ] 配置摘要 AI：
  - [ ] 选择 AI 供应商
  - [ ] 输入 API Key
  - [ ] 点击"保存摘要 AI 配置"按钮
  - [ ] 点击"测试连接"按钮
  - [ ] 观察日志输出（应全部为英文）

**异常测试**：
- [ ] 输入无效的 API Key
- [ ] 输入无效的 Base URL
- [ ] 观察错误弹窗和日志（应显示翻译后的 exception.* key）

**敏感信息脱敏测试**：
- [ ] 在 API Key 输入框中输入密钥，观察日志中是否脱敏（应显示为 `***`）

### 8. 外观设置页面 (Appearance Page)
**功能点**：
- [ ] 切换主题（Light、Dark Gray、Claude Warm 等）
- [ ] 观察日志输出（应全部为英文）
- [ ] 观察主题切换提示（应全部为英文）

### 9. 系统工具页面 (System Page)
**功能点**：
- [ ] 点击"打开输出文件夹"按钮
- [ ] 点击"打开配置文件夹"按钮
- [ ] 观察日志输出（应全部为英文）

## 异常路径测试场景

### 场景 1：无效视频 URL
1. 切换到英文
2. 在频道模式或 URL 列表模式中输入无效 URL（如 `https://www.youtube.com/watch?v=INVALID123`）
3. 点击"开始处理"
4. **验证点**：
   - [ ] GUI 弹窗应显示翻译后的 `exception.*` key（如 `exception.ytdlp_execution_failed`）
   - [ ] 日志面板中的错误消息应为英文
   - [ ] 状态栏中的错误提示应为英文

### 场景 2：Cookie 测试失败
1. 切换到英文
2. 在网络设置页面输入无效的 Cookie 格式
3. 点击"测试 Cookie"
4. **验证点**：
   - [ ] GUI 弹窗应显示翻译后的 `exception.*` key 或错误消息
   - [ ] 日志面板中的错误消息应为英文
   - [ ] Cookie 状态显示应为英文

### 场景 3：代理连接失败
1. 切换到英文
2. 在网络设置页面输入无效的代理地址（如 `socks5://127.0.0.0:9999`）
3. 点击"测试代理"
4. **验证点**：
   - [ ] GUI 弹窗应显示翻译后的错误消息
   - [ ] 日志面板中的错误消息应为英文
   - [ ] 代理测试结果应为英文

### 场景 4：AI 配置错误
1. 切换到英文
2. 在翻译&摘要页面输入无效的 API Key 或 Base URL
3. 点击"保存翻译 AI 配置"或"测试连接"
4. **验证点**：
   - [ ] GUI 弹窗应显示翻译后的 `exception.*` key（如 `exception.ai_client_init_failed`）
   - [ ] 日志面板中的错误消息应为英文
   - [ ] API Key 在日志中应被脱敏（显示为 `***`）

## 敏感信息脱敏测试

### 测试项 1：API Key 脱敏
1. 在翻译&摘要页面输入 API Key（如 `sk-1234567890abcdef`）
2. 点击"保存翻译 AI 配置"
3. **验证点**：
   - [ ] 日志中不应显示完整的 API Key
   - [ ] 日志中应显示脱敏后的格式（如 `sk-***` 或 `***`）

### 测试项 2：Cookie 脱敏
1. 在网络设置页面输入包含敏感信息的 Cookie（如 `PREF=...; VISITOR_INFO1_LIVE=...`）
2. 点击"保存 Cookie"
3. **验证点**：
   - [ ] 日志中不应显示完整的 Cookie 值
   - [ ] 日志中应显示脱敏后的格式（如 `PREF=***` 或 `Cookie: ***`）

### 测试项 3：代理认证信息脱敏
1. 在网络设置页面输入包含认证信息的代理（如 `http://user:password@proxy.com:8080`）
2. 点击"测试代理"
3. **验证点**：
   - [ ] 日志中不应显示完整的密码
   - [ ] 日志中应显示脱敏后的格式（如 `http://user:***@proxy.com:8080`）

### 测试项 4：URL 参数脱敏
1. 在 URL 中包含敏感参数（如 `https://api.example.com?api_key=secret123`）
2. 观察日志输出
3. **验证点**：
   - [ ] 日志中不应显示完整的敏感参数值
   - [ ] 日志中应显示脱敏后的格式（如 `api_key=***`）

## 日志面板验证

### 验证项 1：日志级别过滤
1. 切换到英文
2. 在日志面板中选择不同的日志级别（ALL、DEBUG、INFO、WARN、ERROR）
3. **验证点**：
   - [ ] 过滤标签应为英文
   - [ ] 日志内容应为英文

### 验证项 2：统计信息显示
1. 切换到英文
2. 运行一个任务
3. **验证点**：
   - [ ] 状态栏中的统计信息应为英文（如 "Planned", "Processed", "Success", "Failed"）
   - [ ] Cookie 状态显示应为英文

### 验证项 3：自动滚动
1. 切换到英文
2. 运行一个任务，观察日志自动滚动
3. **验证点**：
   - [ ] "自动滚动"复选框标签应为英文
   - [ ] 日志内容应为英文

## 测试检查清单

### 基础功能测试
- [ ] 所有页面标题和标签均为英文
- [ ] 所有按钮文本均为英文
- [ ] 所有输入框占位符均为英文
- [ ] 所有提示信息均为英文
- [ ] 所有日志输出均为英文
- [ ] 所有状态栏信息均为英文

### 异常处理测试
- [ ] 所有错误弹窗均为英文
- [ ] 所有错误日志均为英文
- [ ] 所有异常消息使用翻译后的 `exception.*` key
- [ ] 所有警告消息均为英文

### 敏感信息保护测试
- [ ] API Key 在日志中已脱敏
- [ ] Cookie 在日志中已脱敏
- [ ] 代理认证信息在日志中已脱敏
- [ ] URL 参数在日志中已脱敏
- [ ] GUI 日志面板中的敏感信息也已脱敏

### 语言切换测试
- [ ] 从中文切换到英文，所有文本立即更新
- [ ] 从英文切换到中文，所有文本立即更新
- [ ] 切换语言后，日志面板中的历史日志也更新为对应语言（如果支持）

## 测试记录

### 测试日期：__________
### 测试人员：__________
### 测试环境：
- 操作系统：__________
- Python 版本：__________
- 应用版本：__________

### 测试结果：
- [ ] 所有测试项通过
- [ ] 发现问题（记录在下方）

### 问题记录：
1. __________
2. __________
3. __________

