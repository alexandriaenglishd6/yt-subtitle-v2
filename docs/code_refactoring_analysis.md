# ä»£ç é‡æ„åˆ†æï¼šå¤§æ–‡ä»¶æ‹†åˆ†å»ºè®®

## æ¦‚è¿°

æœ¬æ–‡æ¡£åˆ†æäº†ä»£ç åº“ä¸­çš„å¤§æ–‡ä»¶ï¼Œæå‡ºäº†æ‹†åˆ†å»ºè®®ï¼Œå¹¶å‡†å¤‡äº†å¿…è¦çš„åˆ†æææ–™ä¾› AI è¿›è¡Œè¯¦ç»†é‡æ„è§„åˆ’ã€‚

## æ–‡ä»¶å¤§å°ç»Ÿè®¡

### è¶…å¤§æ–‡ä»¶ï¼ˆ>1000 è¡Œï¼‰

| æ–‡ä»¶ | è¡Œæ•° | å¤§å° | ä¸»è¦ç±»/å‡½æ•°æ•° | å»ºè®®ä¼˜å…ˆçº§ |
|------|------|------|---------------|------------|
| `core/ai_providers.py` | 1391 | 57.24 KB | 5 ä¸ªç±» | ğŸ”´ é«˜ |
| `core/staged_pipeline.py` | 1345 | 60.62 KB | 3 ä¸ªç±» | ğŸ”´ é«˜ |
| `core/output.py` | 1155 | 50.67 KB | 1 ä¸ªç±» | ğŸŸ¡ ä¸­ |
| `core/pipeline.py` | 1045 | 46.34 KB | å¤šä¸ªå‡½æ•° | ğŸŸ¡ ä¸­ |

### å¤§æ–‡ä»¶ï¼ˆ>800 è¡Œï¼‰

| æ–‡ä»¶ | è¡Œæ•° | å¤§å° | ä¸»è¦ç±»/å‡½æ•°æ•° | å»ºè®®ä¼˜å…ˆçº§ |
|------|------|------|---------------|------------|
| `ui/main_window.py` | 977 | 42.74 KB | 1 ä¸ªç±» | ğŸŸ¡ ä¸­ |
| `ui/pages/network_settings_page.py` | 913 | 45.74 KB | 1 ä¸ªç±» | ğŸŸ¢ ä½ |
| `ui/business_logic.py` | 881 | 37.47 KB | 1 ä¸ªç±» | ğŸŸ¡ ä¸­ |

---

## è¯¦ç»†åˆ†æ

### 1. core/ai_providers.py (1391 è¡Œ) ğŸ”´ é«˜ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- `OpenAICompatibleClient` (çº¦ 300 è¡Œ)
- `GeminiClient` (çº¦ 160 è¡Œ)
- `AnthropicClient` (çº¦ 190 è¡Œ)
- `GoogleTranslateClient` (çº¦ 680 è¡Œ)
- `create_llm_client()` å·¥å‚å‡½æ•°

**é—®é¢˜ï¼š**
- å•ä¸ªæ–‡ä»¶åŒ…å«å¤šä¸ªç‹¬ç«‹çš„å®¢æˆ·ç«¯å®ç°
- `GoogleTranslateClient` ç‰¹åˆ«å¤§ï¼ˆåŒ…å«ç¿»è¯‘é€»è¾‘ï¼‰
- æ¯ä¸ªå®¢æˆ·ç«¯å®ç°ç›¸å¯¹ç‹¬ç«‹ï¼Œå¯ä»¥æ‹†åˆ†

**æ‹†åˆ†å»ºè®®ï¼š**

```
core/
  ai_providers/
    __init__.py              # å¯¼å‡ºæ‰€æœ‰å®¢æˆ·ç«¯å’Œå·¥å‚å‡½æ•°
    base.py                  # åŸºç¡€ç±»/æ¥å£ï¼ˆå¦‚æœéœ€è¦ï¼‰
    openai_compatible.py    # OpenAICompatibleClient
    gemini.py                # GeminiClient
    anthropic.py             # AnthropicClient
    google_translate.py       # GoogleTranslateClient
    factory.py                # create_llm_client å·¥å‚å‡½æ•°
    registry.py               # æ³¨å†Œè¡¨ _LLM_REGISTRY
```

**ä¼˜åŠ¿ï¼š**
- æ¯ä¸ªå®¢æˆ·ç«¯ç‹¬ç«‹æ–‡ä»¶ï¼Œä¾¿äºç»´æŠ¤
- ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™
- ä¾¿äºå•ç‹¬æµ‹è¯•å’Œæ‰©å±•

**è¿ç§»å½±å“ï¼š**
- éœ€è¦æ›´æ–°æ‰€æœ‰å¯¼å…¥è¯­å¥
- ä¿æŒå‘åå…¼å®¹ï¼ˆé€šè¿‡ `__init__.py` å¯¼å‡ºï¼‰

---

### 2. core/staged_pipeline.py (1345 è¡Œ) ğŸ”´ é«˜ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- `StageData` (dataclass, çº¦ 20 è¡Œ)
- `StageQueue` (çº¦ 280 è¡Œ)
- `StagedPipeline` (çº¦ 1045 è¡Œ)

**é—®é¢˜ï¼š**
- `StagedPipeline` ç±»è¿‡å¤§ï¼ŒåŒ…å«æ‰€æœ‰é˜¶æ®µçš„å¤„ç†å™¨å‡½æ•°
- æ¯ä¸ªé˜¶æ®µçš„å¤„ç†å™¨é€»è¾‘ç‹¬ç«‹ï¼Œå¯ä»¥æ‹†åˆ†
- ç±»èŒè´£è¿‡å¤šï¼ˆç¼–æ’ + 5 ä¸ªé˜¶æ®µçš„å¤„ç†é€»è¾‘ï¼‰

**æ‹†åˆ†å»ºè®®ï¼š**

```
core/
  staged_pipeline/
    __init__.py              # å¯¼å‡ºä¸»è¦ç±»
    stage_data.py            # StageData dataclass
    stage_queue.py           # StageQueue ç±»
    pipeline.py              # StagedPipeline ä¸»ç±»ï¼ˆç®€åŒ–ç‰ˆï¼‰
    processors/
      __init__.py
      detect.py              # DETECT é˜¶æ®µå¤„ç†å™¨
      download.py            # DOWNLOAD é˜¶æ®µå¤„ç†å™¨
      translate.py           # TRANSLATE é˜¶æ®µå¤„ç†å™¨
      summarize.py           # SUMMARIZE é˜¶æ®µå¤„ç†å™¨
      output.py              # OUTPUT é˜¶æ®µå¤„ç†å™¨
```

**ä¼˜åŠ¿ï¼š**
- æ¯ä¸ªé˜¶æ®µå¤„ç†å™¨ç‹¬ç«‹ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•
- `StagedPipeline` åªè´Ÿè´£ç¼–æ’ï¼Œé€»è¾‘æ›´æ¸…æ™°
- ä¾¿äºå•ç‹¬ä¼˜åŒ–æŸä¸ªé˜¶æ®µ

**è¿ç§»å½±å“ï¼š**
- éœ€è¦é‡æ„ `StagedPipeline` çš„å¤„ç†å™¨æ–¹æ³•
- ä¿æŒæ¥å£ä¸å˜ï¼Œåªæ”¹å˜å†…éƒ¨å®ç°

---

### 3. core/output.py (1155 è¡Œ) ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- `OutputWriter` ç±»ï¼ˆå•ä¸ªå¤§ç±»ï¼‰

**é—®é¢˜ï¼š**
- å•ä¸ªç±»åŒ…å«æ‰€æœ‰è¾“å‡ºé€»è¾‘
- å¯èƒ½åŒ…å«å¤šç§è¾“å‡ºæ ¼å¼çš„å¤„ç†

**æ‹†åˆ†å»ºè®®ï¼š**

éœ€è¦å…ˆåˆ†æ `OutputWriter` çš„å†…éƒ¨ç»“æ„ï¼Œå¯èƒ½çš„æ‹†åˆ†æ–¹å‘ï¼š

```
core/
  output/
    __init__.py              # å¯¼å‡º OutputWriter
    writer.py                # OutputWriter ä¸»ç±»
    formats/
      __init__.py
      subtitle.py            # å­—å¹•æ–‡ä»¶å†™å…¥
      summary.py             # æ‘˜è¦æ–‡ä»¶å†™å…¥
      metadata.py            # metadata.json å†™å…¥
      archive.py             # archive æ–‡ä»¶å†™å…¥
    utils.py                 # è¾“å‡ºç›¸å…³çš„å·¥å…·å‡½æ•°
```

**ä¼˜åŠ¿ï¼š**
- æŒ‰è¾“å‡ºç±»å‹åˆ†ç¦»é€»è¾‘
- ä¾¿äºæ‰©å±•æ–°çš„è¾“å‡ºæ ¼å¼

---

### 4. core/pipeline.py (1045 è¡Œ) ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- å¤šä¸ªå¤„ç†å‡½æ•°
- `process_single_video()` ä¸»å‡½æ•°
- `process_video_list()` ä¸»å‡½æ•°

**é—®é¢˜ï¼š**
- åŒ…å«æ—§ç‰ˆå’Œæ–°ç‰ˆæµæ°´çº¿çš„é€»è¾‘
- å‡½æ•°èŒè´£å¯èƒ½ä¸å¤Ÿæ¸…æ™°

**æ‹†åˆ†å»ºè®®ï¼š**

```
core/
  pipeline/
    __init__.py              # å¯¼å‡ºä¸»è¦å‡½æ•°
    legacy.py                # æ—§ç‰ˆ TaskRunner é€»è¾‘
    staged.py                # æ–°ç‰ˆ StagedPipeline é€»è¾‘
    single_video.py          # process_single_video ç›¸å…³
    video_list.py            # process_video_list ç›¸å…³
    utils.py                 # æµæ°´çº¿å·¥å…·å‡½æ•°
```

**ä¼˜åŠ¿ï¼š**
- æ–°æ—§ç‰ˆæœ¬é€»è¾‘åˆ†ç¦»
- ä¾¿äºé€æ­¥è¿ç§»å’Œæµ‹è¯•

---

### 5. ui/main_window.py (977 è¡Œ) ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- `MainWindow` ç±»ï¼ˆå•ä¸ªå¤§ç±»ï¼‰

**é—®é¢˜ï¼š**
- GUI ä¸»çª—å£ç±»åŒ…å«æ‰€æœ‰é¡µé¢ç®¡ç†é€»è¾‘
- å¯èƒ½åŒ…å«å¤šä¸ªé¡µé¢çš„åˆå§‹åŒ–ä»£ç 

**æ‹†åˆ†å»ºè®®ï¼š**

```
ui/
  main_window/
    __init__.py              # å¯¼å‡º MainWindow
    window.py                # MainWindow ä¸»ç±»ï¼ˆç®€åŒ–ç‰ˆï¼‰
    page_manager.py          # é¡µé¢ç®¡ç†é€»è¾‘
    event_handlers.py        # äº‹ä»¶å¤„ç†å‡½æ•°
    initialization.py         # åˆå§‹åŒ–ç›¸å…³ä»£ç 
```

**ä¼˜åŠ¿ï¼š**
- èŒè´£åˆ†ç¦»ï¼Œä¸»çª—å£ç±»æ›´æ¸…æ™°
- ä¾¿äºç»´æŠ¤å’Œæ‰©å±•

---

### 6. ui/pages/network_settings_page.py (913 è¡Œ) ğŸŸ¢ ä½ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- å•ä¸ªé¡µé¢ç±»

**é—®é¢˜ï¼š**
- é¡µé¢ç±»å¯èƒ½åŒ…å«å¤šä¸ªåŠŸèƒ½åŒºåŸŸï¼ˆCookieã€ä»£ç†ç­‰ï¼‰

**æ‹†åˆ†å»ºè®®ï¼š**

```
ui/
  pages/
    network_settings/
      __init__.py            # å¯¼å‡º NetworkSettingsPage
      page.py                # ä¸»é¡µé¢ç±»
      cookie_section.py      # Cookie é…ç½®åŒºåŸŸ
      proxy_section.py       # ä»£ç†é…ç½®åŒºåŸŸ
      components.py          # å…±äº«ç»„ä»¶
```

**ä¼˜åŠ¿ï¼š**
- æŒ‰åŠŸèƒ½åŒºåŸŸæ‹†åˆ†
- ä¾¿äºå¤ç”¨å’Œç»´æŠ¤

---

### 7. ui/business_logic.py (881 è¡Œ) ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**å½“å‰ç»“æ„ï¼š**
- `VideoProcessor` ç±»ï¼ˆå•ä¸ªå¤§ç±»ï¼‰

**é—®é¢˜ï¼š**
- ä¸šåŠ¡é€»è¾‘ç±»å¯èƒ½åŒ…å«å¤šä¸ªèŒè´£

**æ‹†åˆ†å»ºè®®ï¼š**

éœ€è¦å…ˆåˆ†æå†…éƒ¨ç»“æ„ï¼Œå¯èƒ½çš„æ‹†åˆ†æ–¹å‘ï¼š

```
ui/
  business_logic/
    __init__.py              # å¯¼å‡º VideoProcessor
    processor.py             # VideoProcessor ä¸»ç±»
    handlers/
      __init__.py
      detection.py           # æ£€æµ‹ç›¸å…³å¤„ç†
      download.py            # ä¸‹è½½ç›¸å…³å¤„ç†
      translation.py         # ç¿»è¯‘ç›¸å…³å¤„ç†
      summarization.py       # æ‘˜è¦ç›¸å…³å¤„ç†
```

**ä¼˜åŠ¿ï¼š**
- æŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†
- ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤

---

## æ‹†åˆ†ä¼˜å…ˆçº§æ€»ç»“

### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³æ‹†åˆ†ï¼‰

1. **core/ai_providers.py** - å¤šä¸ªç‹¬ç«‹å®¢æˆ·ç«¯ï¼Œæ‹†åˆ†æ”¶ç›Šæœ€å¤§
2. **core/staged_pipeline.py** - ç±»è¿‡å¤§ï¼ŒèŒè´£ä¸æ¸…

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆé€æ­¥æ‹†åˆ†ï¼‰

3. **core/output.py** - éœ€è¦å…ˆåˆ†æå†…éƒ¨ç»“æ„
4. **core/pipeline.py** - æ–°æ—§ç‰ˆæœ¬é€»è¾‘åˆ†ç¦»
5. **ui/main_window.py** - GUI ä¸»çª—å£é‡æ„
6. **ui/business_logic.py** - ä¸šåŠ¡é€»è¾‘æ¨¡å—åŒ–

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆå¯é€‰ï¼‰

7. **ui/pages/network_settings_page.py** - é¡µé¢ç±»ï¼Œå½±å“è¾ƒå°

---

## æ‹†åˆ†åŸåˆ™

1. **å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªæ–‡ä»¶/ç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **ä¿æŒæ¥å£ä¸å˜**ï¼šé€šè¿‡ `__init__.py` ä¿æŒå‘åå…¼å®¹
3. **æ¸è¿›å¼é‡æ„**ï¼šä¸€æ¬¡æ‹†åˆ†ä¸€ä¸ªæ–‡ä»¶ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸
4. **æµ‹è¯•é©±åŠ¨**ï¼šæ‹†åˆ†å‰ç¡®ä¿æœ‰æµ‹è¯•è¦†ç›–

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **è¯¦ç»†åˆ†æ**ï¼šå¯¹æ¯ä¸ªæ–‡ä»¶è¿›è¡Œæ›´æ·±å…¥çš„ç»“æ„åˆ†æ
2. **ä¾èµ–åˆ†æ**ï¼šåˆ†ææ–‡ä»¶é—´çš„ä¾èµ–å…³ç³»
3. **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿æ‹†åˆ†å‰æœ‰è¶³å¤Ÿçš„æµ‹è¯•
4. **åˆ†æ­¥å®æ–½**ï¼šæŒ‰ä¼˜å…ˆçº§é€æ­¥æ‹†åˆ†

---

## æ³¨æ„äº‹é¡¹

- æ‹†åˆ†æ—¶è¦ä¿æŒå‘åå…¼å®¹
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
- æ›´æ–°ç›¸å…³æ–‡æ¡£
- è€ƒè™‘ Git å†å²è®°å½•ï¼ˆä½¿ç”¨ `git mv` ä¿ç•™å†å²ï¼‰

