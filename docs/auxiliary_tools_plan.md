# ç‹¬ç«‹è¾…åŠ©å·¥å…·è®¾è®¡

> æœ¬æ–‡æ¡£ä» `v2_high_concurrency_plan.md` æ‹†åˆ†å‡ºæ¥ï¼Œæè¿°ç‹¬ç«‹äº v2.0 ä¸»ç¨‹åºçš„è¾…åŠ©å·¥å…·ã€‚
> 
> **æ³¨æ„**ï¼šè¿™äº›å·¥å…·ä¸é›†æˆåˆ° v2.0 ä¸»ç¨‹åºä¸­ï¼Œå¯ç‹¬ç«‹ä½¿ç”¨ã€‚

---

## å·¥å…·åˆ—è¡¨

| å·¥å…· | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| æ–‡ä»¶åˆå¹¶å™¨ | å°†å¤šä¸ªå­—å¹•/æ‘˜è¦æ–‡ä»¶åˆå¹¶ä¸ºå•ä¸ª MD | å¾…å®ç° |
| éŸ³é¢‘è½¬æ–‡å­—ï¼ˆASRï¼‰ | YouTube è§†é¢‘éŸ³é¢‘è½¬æ–‡å­— | å¾…å®ç° |
| ç‹¬ç«‹ç¿»è¯‘/æ‘˜è¦ CLI | ç‹¬ç«‹ä½¿ç”¨ç¿»è¯‘/æ‘˜è¦åŠŸèƒ½ | å¯é€‰ |

---

## æ–‡ä»¶åˆå¹¶å™¨

### èƒŒæ™¯

NotebookLM æœ‰æ¥æºæ•°é‡é™åˆ¶ï¼ˆ50 ä¸ªï¼‰ï¼Œå¤„ç†å¤§é‡è§†é¢‘æ—¶éœ€è¦å°†å¤šä¸ªæ–‡ä»¶åˆå¹¶ã€‚

### åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| å¤šæ–‡ä»¶åˆå¹¶ | å°†å¤šä¸ª TXT/MD æ–‡ä»¶åˆå¹¶ä¸ºå•ä¸ª MD |
| è‡ªåŠ¨æ‹†åˆ† | è¶…è¿‡å¤§å°é™åˆ¶æ—¶è‡ªåŠ¨æ‹†åˆ† |
| ä¿ç•™ç»“æ„ | åˆå¹¶åä¿ç•™æ¯ä¸ªæ–‡ä»¶çš„æ ‡é¢˜å’Œåˆ†éš” |

### ç”¨æ³•

```bash
python scripts/merge_files.py --input ./output --output combined.md
```

### é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--input` | è¾“å…¥æ–‡ä»¶å¤¹ | å¿…å¡« |
| `--output` | è¾“å‡ºæ–‡ä»¶å | `combined.md` |
| `--max-size` | å•æ–‡ä»¶æœ€å¤§å¤§å°ï¼ˆMBï¼‰ | 10 |
| `--split` | è¶…è¿‡å¤§å°è‡ªåŠ¨æ‹†åˆ† | true |

### è¾“å‡ºæ ¼å¼

```markdown
# åˆå¹¶æ–‡æ¡£

> å…±åŒ…å« 50 ä¸ªè§†é¢‘
> ç”Ÿæˆæ—¶é—´: 2025-12-25

---

## 1. è§†é¢‘æ ‡é¢˜ 1

å†…å®¹...

---

## 2. è§†é¢‘æ ‡é¢˜ 2

å†…å®¹...
```

### æ–‡ä»¶ä½ç½®

```
yt-subtitle-v2/
â””â”€â”€ scripts/
    â””â”€â”€ merge_files.py   # ç‹¬ç«‹åˆå¹¶å·¥å…·
```

---

## éŸ³é¢‘è½¬æ–‡å­—ï¼ˆASRï¼‰

> **æ³¨æ„**ï¼šæ­¤å·¥å…·ä¸ºç‹¬ç«‹è¾…åŠ©å·¥å…·ï¼Œä¸é›†æˆåˆ° v2.0 ä¸»ç¨‹åºä¸­ã€‚

### æ¨¡å—è·¯å¾„

| æ–‡æ¡£ | è·¯å¾„ |
|------|------|
| è¯¦ç»†è®¾è®¡æ–¹æ¡ˆ | [docs/asr_module_design.md](./asr_module_design.md) |
| æŠ€æœ¯æŒ‡å— | [docs/asr_guide.md](./asr_guide.md) |
| å®ç°ä»£ç  | `tools/audio_transcriber/` |

### åŠŸèƒ½æ¦‚è¿°

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **ASR è½¬æ–‡å­—** | æ”¯æŒ Whisper API / Deepgram / æœ¬åœ° GPU |
| **ç¿»è¯‘** | æ”¯æŒ DeepL / ç™¾åº¦ / é€šç”¨ AI |
| **æ‘˜è¦** | æ”¯æŒ DeepSeek / Kimi / GPT |
| **è´¹ç”¨ç»Ÿè®¡** | API ç”¨é‡è¿½è¸ªï¼Œæ”¯æŒè‡ªå®šä¹‰ä»·æ ¼ |
| **å¹¶å‘å¤„ç†** | æ‰¹é‡ä»»åŠ¡å¹¶å‘ |
| **ä»£ç†/Cookie** | å¤ç”¨ä¸»ç¨‹åºç½‘ç»œåŠŸèƒ½ |

### æ•´ä½“å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å…¥: YouTube URL / URL åˆ—è¡¨                                   â”‚
â”‚        â†“                                                        â”‚
â”‚  1. ä¸‹è½½éŸ³é¢‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ yt-dlpï¼ˆæ”¯æŒä»£ç†/Cookieï¼‰              â”‚
â”‚        â†“                                                        â”‚
â”‚  2. ASR è½¬æ–‡å­— â”€â”€â”€â”€â”€â”€â”€â”€â†’ Whisper API / Deepgram / æœ¬åœ° GPU      â”‚
â”‚        â†“                                                        â”‚
â”‚  3. ç¿»è¯‘ï¼ˆå¯é€‰ï¼‰â”€â”€â”€â”€â”€â”€â”€â†’ DeepL / ç™¾åº¦ / é€šç”¨ AI                 â”‚
â”‚        â†“                                                        â”‚
â”‚  4. æ‘˜è¦ï¼ˆå¯é€‰ï¼‰â”€â”€â”€â”€â”€â”€â”€â†’ DeepSeek / Kimi / GPT                  â”‚
â”‚        â†“                                                        â”‚
â”‚  5. è¾“å‡º â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ SRT / TXT / MD                         â”‚
â”‚        â†“                                                        â”‚
â”‚  6. è´¹ç”¨ç»Ÿè®¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ åˆ†é¡¹ç»Ÿè®¡ + æŠ¥å‘Š                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ASR ä¾›åº”å•†å¯¹æ¯”

| æ–¹æ¡ˆ | è´¹ç”¨ | éœ€è¦ GPU | è´¨é‡ | é€‚åˆåœºæ™¯ |
|------|------|----------|------|----------|
| **æœ¬åœ° faster-whisper** | å…è´¹ | âœ… | â­â­â­â­â­ | æœ‰ GPUã€æ‰¹é‡å¤„ç† |
| **Whisper API** | $0.006/åˆ†é’Ÿ | âŒ | â­â­â­â­â­ | è´¨é‡ä¼˜å…ˆ |
| **Deepgram API** | $0.0043/åˆ†é’Ÿ | âŒ | â­â­â­â­ | æˆæœ¬ä¼˜å…ˆï¼ˆ$200 å…è´¹ï¼‰ |

### å¿«é€Ÿå†³ç­–

| ç”¨æˆ·æƒ…å†µ | æ¨è |
|----------|------|
| æœ‰ GPU (â‰¥6GB) | æœ¬åœ° faster-whisper |
| æ—  GPUï¼Œè´¨é‡ä¼˜å…ˆ | Whisper API |
| æ—  GPUï¼Œæˆæœ¬ä¼˜å…ˆ | Deepgramï¼ˆ$200 å…è´¹ï¼‰ |

### ä½¿ç”¨ç¤ºä¾‹

```bash
# å•ä¸ªè§†é¢‘
python -m tools.audio_transcriber "https://youtube.com/watch?v=xxx"

# æ‰¹é‡å¤„ç† + ä»£ç† + Cookie
python -m tools.audio_transcriber urls.txt \
    -c 5 \
    --proxy http://127.0.0.1:7890 \
    --cookie cookies.txt \
    --translate \
    --summarize
```

### ç›®å½•ç»“æ„

```
tools/audio_transcriber/
â”œâ”€â”€ main.py              # CLI å…¥å£
â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”œâ”€â”€ cost_tracker.py      # è´¹ç”¨ç»Ÿè®¡
â”œâ”€â”€ providers/           # ASR ä¾›åº”å•†
â”‚   â”œâ”€â”€ whisper_api.py
â”‚   â”œâ”€â”€ deepgram.py
â”‚   â””â”€â”€ local_whisper.pyï¼ˆæ‰©å±•ï¼‰
â”œâ”€â”€ extractors/          # éŸ³é¢‘æå–
â”‚   â””â”€â”€ youtube.py
â”œâ”€â”€ processors/          # åå¤„ç†
â”‚   â”œâ”€â”€ translator.py
â”‚   â””â”€â”€ summarizer.py
â””â”€â”€ utils/
    â”œâ”€â”€ rate_limiter.py
    â””â”€â”€ concurrent.py
```

### ä¸ºä»€ä¹ˆåšæˆç‹¬ç«‹æ¨¡å—ï¼Ÿ

| ç†ç”± | è¯´æ˜ |
|------|------|
| ä¾èµ–éš”ç¦» | faster-whisper æœ‰ç‰¹æ®Š CUDA ä¾èµ– |
| å¯é€‰å®‰è£… | ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸å®‰è£… |
| ä¿æŒç²¾ç®€ | v2.0 ä¸»ç¨‹åºèšç„¦æ ¸å¿ƒåŠŸèƒ½ |
| çµæ´»å¤ç”¨ | å…¶ä»–é¡¹ç›®ä¹Ÿèƒ½ç”¨ |

### v2.0 é¢„ç•™è®¾è®¡ï¼ˆæœªæ¥é›†æˆï¼‰

> è™½ç„¶å½“å‰ä¸é›†æˆ ASRï¼Œä½†é¢„ç•™æ¥å£æ–¹ä¾¿æœªæ¥æ‰©å±•

#### è¿›åº¦è¿½è¸ªæ¥å£é¢„ç•™

```python
class ProgressTracker:
    """è¿›åº¦è¿½è¸ªï¼ˆé¢„ç•™ ASR æ‰©å±•ï¼‰"""
    
    def __init__(self):
        self.stages = {
            'detect': {'total': 0, 'completed': 0},
            'download': {'total': 0, 'completed': 0},
            'asr': {'total': 0, 'completed': 0},  # é¢„ç•™
            'translate': {'total': 0, 'completed': 0},
            'summary': {'total': 0, 'completed': 0},
            'output': {'total': 0, 'completed': 0},
        }
```

#### UI æ˜¾ç¤ºé¢„ç•™

```python
def get_visible_stages(self):
    """è·å–å¯è§é˜¶æ®µï¼ˆé¢„ç•™ ASR å¼€å…³ï¼‰"""
    stages = ['detect', 'download', 'translate', 'summary', 'output']
    if self.asr_enabled:  # é¢„ç•™å¼€å…³
        stages.insert(2, 'asr')
    return stages
```

#### é¢„ç•™æˆæœ¬

| é¢„ç•™å†…å®¹ | ä»£ç é‡ |
|----------|--------|
| è¿›åº¦æ¥å£ ASR é˜¶æ®µ | ~10 è¡Œ |
| UI æ˜¾ç¤ºå¼€å…³ | ~5 è¡Œ |
| **æ€»è®¡** | **~15 è¡Œ** |

---

## ç‹¬ç«‹ç¿»è¯‘/æ‘˜è¦å·¥å…·ï¼ˆå¯é€‰ï¼‰

> âš ï¸ **å¯é€‰åŠŸèƒ½**ï¼šå¦‚éœ€ç‹¬ç«‹ä½¿ç”¨ç¿»è¯‘/æ‘˜è¦ï¼Œè¯·é¢„ç•™æ ¸å¿ƒåº“æ¥å£

### æ–¹æ¡ˆè¯´æ˜

å°†ç¿»è¯‘/æ‘˜è¦æŠ½å–ä¸ºæ ¸å¿ƒåº“ï¼Œæ”¯æŒï¼š
- v2.0 ä¸»ç¨‹åºè°ƒç”¨
- ç‹¬ç«‹ CLI å·¥å…·è°ƒç”¨
- æœªæ¥ API è°ƒç”¨

### ç›®å½•ç»“æ„

```
core/
â”œâ”€â”€ translator/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py          # ç¿»è¯‘æ¥å£
â”‚   â””â”€â”€ providers/       # OpenAI/DeepSeek/DeepL
â”œâ”€â”€ summarizer/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py          # æ‘˜è¦æ¥å£
â”‚   â””â”€â”€ providers/
â””â”€â”€ common/
    â”œâ”€â”€ key_pool.py
    â””â”€â”€ cost_tracker.py

tools/
â”œâ”€â”€ translator_cli.py    # ç‹¬ç«‹ç¿»è¯‘ CLI
â””â”€â”€ summarizer_cli.py    # ç‹¬ç«‹æ‘˜è¦ CLI
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# ç‹¬ç«‹ç¿»è¯‘
python -m tools.translator input.txt -o output.txt --provider deepseek

# ç‹¬ç«‹æ‘˜è¦
python -m tools.summarizer input.txt -o summary.txt --provider kimi
```

### é¢„ç•™æ¥å£

```python
# core/translator/base.py
class BaseTranslator:
    """ç¿»è¯‘å™¨åŸºç±»ï¼ˆé¢„ç•™ç‹¬ç«‹è°ƒç”¨ï¼‰"""
    
    def translate(self, text: str, target_lang: str) -> str:
        raise NotImplementedError
    
    @classmethod
    def from_config(cls, config: dict):
        """ä»é…ç½®åˆ›å»ºç¿»è¯‘å™¨ï¼ˆé¢„ç•™ï¼‰"""
        pass
```

### å·¥ä½œé‡

| ä»»åŠ¡ | å·¥ä½œé‡ | ç±»å‹ |
|------|--------|------|
| æŠ½å–æ ¸å¿ƒåº“ | 1 å¤© | å¯é€‰ |
| åˆ›å»º CLI å·¥å…· | 0.5 å¤© | å¯é€‰ |
| **æ€»è®¡** | **1.5 å¤©** | |

> ğŸ’¡ **æç¤º**ï¼šv2.0 å¼€å‘æ—¶å»ºè®®é¢„ç•™æ¥å£ï¼ˆBaseTranslator/BaseSummarizerï¼‰ï¼Œæ–¹ä¾¿åç»­æ‰©å±•

---

## ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [v2_high_concurrency_plan.md](./v2_high_concurrency_plan.md) | v2.0 æ€»ä½“è§„åˆ’ |
| [asr_module_design.md](./asr_module_design.md) | ASR æ¨¡å—è¯¦ç»†è®¾è®¡ |
| [asr_guide.md](./asr_guide.md) | ASR æŠ€æœ¯æŒ‡å— |
| [subtitle_processing_plan.md](./subtitle_processing_plan.md) | å­—å¹•æ¸…æ´—æ–¹æ¡ˆ |
